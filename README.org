#+STARTUP: showall indent

* Fakeymacs

Windows の操作を Emacs のキーバインドで行うための設定です。

Keyhac for Windows ver 1.82 以上のバージョンでご利用ください。

- https://sites.google.com/site/craftware/keyhac-ja

詳しくは以下を参照してください。

- [[https://www49.atwiki.jp/ntemacs/pages/25.html][Windows の操作を Emacs のキーバインドで行うための設定 （Keyhac版）]]

** Light バージョン

機能を制限した Light バージョン（config_light.py）も登録しました。Full バージョン（config.py）
との違いは以下のとおりとなります。

|--------------------------------------------------+--------------------+-----------------|
| 機能                                             | config.py          | config_light.py |
|--------------------------------------------------+--------------------+-----------------|
| Emacs標準キーバインド                            | ○                 | ○              |
| Emacs日本語入力モード [1]                        | ○                 | ○              |
| Emacsシフトモード [2]                            | ○（初期値：無効） | ×              |
| other_window                                     | ○                 | ×              |
| shell_command                                    | ○                 | ×              |
| ウィンドウの最小化、リストア                     | ○                 | ×              |
| アクティブウィンドウの切り替え                   | ○ [3]             | ○ [3]          |
| アクティブウィンドウのディスプレイ間移動         | ○                 | ×              |
| 仮想デスクトップの切り替え                       | ○                 | ×              |
| クリップボードリスト                             | ○                 | ×              |
| ランチャーリスト                                 | ○                 | ×              |
| Excel や Emacs と連携するためのオプション設定    | ○（初期値：無効） | ×              |
| キーボードを切替えて利用するためのオプション設定 | ○（初期値：無効） | ×              |
|--------------------------------------------------+--------------------+-----------------|

[1] IME が ON の時に文字（英数字か、スペースを除く特殊文字）を入力すると起動するモードです。
（モードに入ると、▲のマークが表示されます。） Emacs日本語入力モードになると Emacsキーバインド
として利用できるキーが限定され、その他のキーは Windows にそのまま渡されるようになるため、
IME のショートカットキーが利用できるようになります。

[2] 本設定のキーバインドと IME のショートカットキーが被って設定されている場合、日本語入力中に
そのキーを Shiftキーと一緒に押すことで IME のショートカットキーが利用できるようになるモードです。

[3] アクティブウィンドウの切り替えのキーの初期値は未設定（None）としています。このため、起動
するためのキーは、デフォルトキーの A-S-Tab、A-Tab となります。起動後は A-p、A-n で
アクティブウィンドウの切り替え、A-g で切り替え画面の終了（キャンセル）が利用できます。

** その他

上記で紹介している wiki のページに詳しく書いておりますが、本設定は IME を 「Google 日本語入力」
とし、プロパティの「キー設定」を「ことえり」にしたときに最適に動作するように調整しています。
「Google 日本語入力」は、mozc_emacs_helper.exe を利用することで NTEmacs や WSL の Emacs とも
連携可能な IME となっておりますので、利用されていない方は是非お試しください。

⇒ （2020/05/10 追記） emacs_ime_mode_key 変数の追加により、Micorosoft IME でも「ことえり」と
同様なキーバインドを設定できるようになりました。
